{
  "discovery_metadata": {
    "discovered_at": "2025-01-02T10:07:00Z",
    "technology_stack": {
      "framework": "Streamlit",
      "language": "Python",
      "ui_library": "streamlit",
      "backend_services": [
        "OpenAI API (Whisper, GPT)",
        "LangChain/LangGraph (Agent framework)"
      ],
      "data_persistence": "JSON file (tasks.json)"
    },
    "entry_point": "app.py",
    "main_function": "main()"
  },
  "application": {
    "title": "üé§ Voice Task Manager",
    "description": "Voice-enabled task management system with AI processing",
    "page_config": {
      "page_title": "Voice Task Manager",
      "page_icon": "üé§",
      "layout": "wide"
    }
  },
  "interactive_elements": {
    "sidebar_ai_assistant": {
      "type": "collapsible_panel",
      "location": "st.sidebar",
      "capabilities": {
        "toggle_panel": {
          "element": "st.button",
          "key": "toggle_help",
          "action": "Opens/closes AI assistant panel",
          "state_modified": "help_panel_open"
        },
        "mode_selection": {
          "elements": ["st.button (mode_question)", "st.button (mode_command)"],
          "actions": {
            "question_mode": "Switch to Q&A mode for help",
            "command_mode": "Switch to command execution mode"
          },
          "state_modified": "help_mode"
        },
        "voice_input": {
          "element": "st.audio_input",
          "key_pattern": "help_audio_{version}",
          "workflow": [
            "Record audio",
            "Transcribe via WhisperService",
            "Process via HelpService/AgentService",
            "Execute tools if in command mode",
            "Display response"
          ],
          "can_modify": "Tasks (in command mode)"
        },
        "text_input_form": {
          "element": "st.form with st.text_input",
          "key": "help_text_form",
          "workflow": [
            "Type text command/question",
            "Submit form",
            "Process via HelpService/AgentService",
            "Execute tools if in command mode"
          ],
          "can_modify": "Tasks (in command mode)"
        },
        "clear_button": {
          "element": "st.button",
          "key": "clear_response",
          "action": "Clears transcription and response",
          "state_modified": ["help_response", "help_question", "help_audio_version"]
        }
      },
      "limitations": {
        "audio_processing": "Requires rerun after processing",
        "form_submission": "Form clears on submit",
        "mode_persistence": "Mode selection persists in session state"
      }
    },
    "main_mode_selector": {
      "type": "radio_selector",
      "location": "main content area",
      "element": "st.radio",
      "key": "mode_selector",
      "options": ["üß† Brain Dump", "üéØ Command"],
      "capabilities": {
        "mode_switching": {
          "action": "Switches between braindump and command modes",
          "state_modified": ["mode", "last_mode"],
          "side_effects": "Clears audio state when mode changes"
        }
      },
      "actual_behavior": "Command mode redirects to sidebar AI Assistant"
    },
    "voice_input_section": {
      "type": "audio_recorder",
      "location": "column 1 of main content",
      "element": "st.audio_input",
      "capabilities": {
        "audio_recording": {
          "workflow": [
            "Click to record",
            "Audio captured as bytes",
            "Transcribed via WhisperService",
            "Processed based on mode"
          ]
        },
        "braindump_processing": {
          "condition": "mode == 'braindump'",
          "workflow": [
            "LLMService.process_braindump()",
            "Extract tasks with priorities/categories",
            "Display task preview",
            "Show 'Add to Task List' button"
          ],
          "can_create": "New tasks with text, priority, category"
        },
        "command_mode_behavior": {
          "condition": "mode == 'command'",
          "action": "Shows warning to use AI Assistant panel",
          "reason": "Commands require AgentService tools"
        },
        "add_tasks_button": {
          "element": "st.button",
          "key": "add_tasks",
          "condition": "processed_tasks != None",
          "action": "Adds all processed tasks to TaskManager",
          "state_modified": ["processed_tasks", "transcription"],
          "triggers": "st.rerun()"
        },
        "clear_results_button": {
          "element": "st.button",
          "key": "clear_results",
          "action": "Clears processing results",
          "state_modified": ["processed_tasks", "transcription", "last_command_result"]
        }
      }
    },
    "quick_actions": {
      "type": "action_buttons",
      "location": "column 1 bottom",
      "buttons": {
        "clear_all": {
          "element": "st.button",
          "label": "Clear All Tasks",
          "action": "task_manager.clear_all()",
          "can_delete": "All tasks",
          "confirmation": "None (immediate)",
          "triggers": "st.rerun()"
        },
        "auto_prioritize": {
          "element": "st.button",
          "label": "Auto-Prioritize",
          "action": "llm.prioritize_tasks(current_tasks)",
          "can_modify": "Task priorities via AI",
          "workflow": [
            "Get all tasks",
            "Send to LLM for analysis",
            "Update priorities based on AI response"
          ]
        }
      }
    },
    "task_list_filters": {
      "type": "dropdown_filters",
      "location": "column 2 top",
      "elements": {
        "priority_filter": {
          "element": "st.selectbox",
          "key": "priority_filter",
          "options": ["All", "High", "Medium", "Low"],
          "action": "Filters displayed tasks by priority"
        },
        "category_filter": {
          "element": "st.selectbox",
          "key": "category_filter",
          "options": ["All", "Client", "Business", "Personal"],
          "action": "Filters displayed tasks by category"
        },
        "status_filter": {
          "element": "st.selectbox",
          "key": "status_filter",
          "options": ["All", "Pending", "Completed"],
          "action": "Filters displayed tasks by completion status"
        }
      },
      "behavior": "Filters apply cumulatively in real-time"
    },
    "task_item_row": {
      "type": "composite_row",
      "location": "column 2 task list",
      "elements": {
        "completion_checkbox": {
          "element": "st.checkbox",
          "key_pattern": "check_{task_id}",
          "action": "Toggles task completion",
          "workflow": [
            "Check state change",
            "If changed, call task_manager.toggle_task()",
            "Updates completed status and timestamp"
          ],
          "can_modify": "Task completed status"
        },
        "edit_button": {
          "element": "st.button",
          "key_pattern": "edit_btn_{task_id}",
          "icon": "‚úèÔ∏è",
          "action": "Enters edit mode",
          "state_modified": "edit_{task_id}",
          "triggers": "Row switches to edit interface"
        },
        "edit_mode_interface": {
          "condition": "st.session_state[edit_{task_id}] == True",
          "elements": {
            "text_input": {
              "element": "st.text_input",
              "key_pattern": "text_{task_id}",
              "initial_value": "Current task text",
              "can_modify": "Task text content"
            },
            "save_button": {
              "element": "st.button",
              "key_pattern": "save_{task_id}",
              "icon": "üíæ",
              "action": "task_manager.update_task(task_id, text=new_text)",
              "state_modified": "edit_{task_id} = False",
              "can_modify": "Task text permanently"
            },
            "cancel_button": {
              "element": "st.button",
              "key_pattern": "cancel_{task_id}",
              "icon": "‚ùå",
              "action": "Cancels edit without saving",
              "state_modified": "edit_{task_id} = False"
            }
          }
        },
        "delete_button": {
          "element": "st.button",
          "key_pattern": "del_{task_id}",
          "icon": "üóëÔ∏è",
          "action": "task_manager.delete_task(task_id)",
          "can_delete": "Individual task",
          "confirmation": "None (immediate)"
        }
      },
      "visual_indicators": {
        "priority": "Emoji (üî¥/üü°/üü¢)",
        "category": "Emoji (üë§/üíº/üè†)",
        "completion": "Strikethrough text when completed"
      }
    },
    "statistics_display": {
      "type": "metrics_dashboard",
      "location": "column 2 bottom",
      "element": "st.metric (multiple)",
      "displays": [
        "Total Tasks",
        "Completed",
        "Pending",
        "High/Medium/Low Priority counts",
        "Client/Business/Personal counts"
      ],
      "read_only": true
    }
  },
  "backend_capabilities": {
    "agent_service_tools": {
      "description": "LangChain tools available in command mode",
      "tools": [
        {
          "name": "list_tasks",
          "can_read": "All tasks with IDs",
          "parameters": ["show_completed: bool"]
        },
        {
          "name": "add_task",
          "can_create": "New tasks",
          "parameters": ["text: str", "priority: str", "category: str"]
        },
        {
          "name": "complete_task",
          "can_modify": "Task completion status",
          "parameters": ["task_id: str"]
        },
        {
          "name": "update_task",
          "can_modify": "Task text, priority, category",
          "parameters": ["task_id: str", "text: str", "priority: str", "category: str"]
        },
        {
          "name": "delete_task",
          "can_delete": "Individual tasks",
          "parameters": ["task_id: str"]
        },
        {
          "name": "get_tasks_by_priority",
          "can_read": "Filtered task lists",
          "parameters": ["priority: str"]
        },
        {
          "name": "get_tasks_by_category",
          "can_read": "Filtered task lists",
          "parameters": ["category: str"]
        },
        {
          "name": "get_pending_tasks",
          "can_read": "Incomplete tasks"
        },
        {
          "name": "get_completed_tasks",
          "can_read": "Completed tasks"
        },
        {
          "name": "get_task_stats",
          "can_read": "Task statistics"
        }
      ]
    },
    "task_manager": {
      "description": "Core task management service",
      "storage": "tasks.json file",
      "operations": {
        "add_task": "Creates new task with UUID",
        "update_task": "Modifies task properties",
        "toggle_task": "Switches completion status",
        "delete_task": "Removes task permanently",
        "clear_all": "Deletes all tasks",
        "get_tasks": "Returns all tasks",
        "get_stats": "Calculates statistics"
      },
      "task_schema": {
        "id": "UUID string",
        "text": "Task description",
        "priority": "high/medium/low",
        "category": "client/business/personal or null",
        "completed": "boolean",
        "created_at": "ISO timestamp",
        "modified_at": "ISO timestamp",
        "completed_at": "ISO timestamp or null"
      }
    }
  },
  "data_flow": {
    "voice_to_task": [
      "Audio input captured",
      "WhisperService transcribes to text",
      "LLMService processes text",
      "Tasks extracted with metadata",
      "User confirms addition",
      "TaskManager persists to JSON",
      "UI refreshes via st.rerun()"
    ],
    "command_execution": [
      "User speaks/types command",
      "HelpService routes to AgentService",
      "AgentService invokes LangGraph agent",
      "Agent uses tools to modify tasks",
      "TaskManager updates JSON",
      "UI refreshes automatically"
    ],
    "manual_editing": [
      "User clicks edit button",
      "Session state tracks edit mode",
      "Text input appears",
      "User modifies and saves",
      "TaskManager updates task",
      "Session state cleared",
      "Row returns to display mode"
    ]
  },
  "limitations_and_truths": {
    "edit_capabilities": {
      "what_can_be_edited": [
        "Task text (via edit button)",
        "Task completion status (via checkbox)",
        "Task priority (via AI agent only)",
        "Task category (via AI agent only)"
      ],
      "what_cannot_be_edited_directly": [
        "Task priority (no UI dropdown in edit mode)",
        "Task category (no UI dropdown in edit mode)",
        "Task ID (immutable)",
        "Timestamps (system-managed)"
      ],
      "workarounds": [
        "Use AI Assistant in command mode to change priority/category",
        "Delete and recreate task with different attributes"
      ]
    },
    "command_mode_redirect": {
      "issue": "Main voice input command mode doesn't execute commands",
      "reason": "Commands require AgentService tools",
      "solution": "Must use sidebar AI Assistant panel"
    },
    "real_time_updates": {
      "mechanism": "st.rerun() triggers full page refresh",
      "limitation": "Not true real-time, requires full reload",
      "state_persistence": "Session state maintains continuity"
    },
    "audio_processing": {
      "limitation": "Audio hash prevents reprocessing same audio",
      "workaround": "Version counter forces widget refresh"
    }
  }
}